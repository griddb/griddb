# GridDB CE 5.6

## 変更点

GridDB CE V5.6の主な変更点は以下のとおりです。

<データベース機能>

- データベース圧縮アルゴリズムの追加

    これまでデータベース圧縮機能を提供していましたが、今回、データベース圧縮に利用できる圧縮アルゴリズムを追加しました。性能やサイズなど要件に応じて選択できるようになります。

<SQLの強化>

- テーブルパーティショニングの強化

    SQLのテーブルパーティショニング機能を用いて、日々増加する大規模なテーブルのデータを一定の時間間隔で分割し、GridDB内部で小分けして管理できます(インターバルパーティショニングとインターバルハッシュパーティショニング)。小分けにすることで、大規模なテーブルのデータをクラスタの各ノードやスレッドにデータを分散配置できるようになり、分散並列に処理できるようになります。これまでは最小の分割単位は1日(DAY)でしたが、今回、1時間(HOUR)単位でテーブル分割できるようになりました。

- 索引利用によるSQL min/maxの高速化

    SQLのmin/maxの演算を行う際、可能な限り索引を利用して高速化できるようになりました。

<時系列データ管理>

- 時系列データ自動集計

    蓄積された大量の時系列データを自動的に集計して集計結果を蓄積しておくことで、ユーザが集計結果を取得する際に、処理時間を短縮できるようになります。今回、GridDB CLI(gs_sh)を使って自動集計が実現できるようになりました。

---

## データベース圧縮アルゴリズムの追加

### 圧縮アルゴリズム

データブロック圧縮は以下の2種類のアルゴリズムから選択することができます。

- ZLIB圧縮: ZLIBライブラリによる圧縮 (V5.6より古いバージョンから使用できる圧縮アルゴリズム)
- ZSTD圧縮: ZSTD(Zstandard)ライブラリによる圧縮(V5.6から選択可能)。ZLIB圧縮より圧縮解凍速度や圧縮率で優れています。

### 設定方法

ノード定義ファイル(gs_node.json)で設定します。

  * dataStore/storeCompressionMode：以下の文字列を設定します。
    - "NO_COMPRESSION": 圧縮機能を無効にする（既定値）
    - "COMPRESSION_ZLIB" または "COMPRESSION": ZLIB圧縮機能を有効にする
    - "COMPRESSION_ZSTD": ZSTD圧縮機能を有効にする

### 制限事項

GridDB V5.5以前のV5系のバージョンで作成されたデータベースでも読込み、起動が行えます。
ただし、一度でもGridDB V5.6で追加された圧縮設定(COMPRESSION_ZSTD)にして起動すると、それ以降はV5.5以前のバージョンでは読込み、起動ができなくなります。

## テーブルパーティショニングの強化

インターバル(ハッシュ)パーティショニングテーブルを作成する場合、1時間単位でテーブル分割できるようになりました。

インターバルパーティショニングテーブルを作成する場合の例：

- テーブル(コレクション)

<pre>
CREATE TABLE [IF NOT EXISTS] テーブル名 ( 列定義 [, 列定義 ...] [, PRIMARY KEY(列名 [, ...])])
[WITH (プロパティキー=プロパティ値, ...)]
PARTITION BY RANGE(パーティショニングキーの列名) EVERY(分割幅値 [, 単位 ]) ;
</pre>

- 時系列テーブル(時系列コンテナ)

<pre>
CREATE TABLE [IF NOT EXISTS] テーブル名 ( 列定義 [, 列定義 ...] )
USING TIMESERIES [WITH (プロパティキー=プロパティ値, ...)]
PARTITION BY RANGE(パーティショニングキーの列名) EVERY(分割幅値 [, 単位 ]) ;
</pre>

※ TIMESTAMP型(精度指定付きTIMESTAMP型を含む)の列を指定した場合は、単位を指定する必要があります。単位に指定できる値は、DAY/HOURです。


## 時系列データ自動集計

あらかじめ集計対象のコンテナと出力先のコンテナを作成し、作成した集計対象のコンテナに対して、時系列データを登録します。登録した時系列データに対して集計を行い、出力先のコンテナに登録を行います。集計処理はGridDB CLI(gs_sh)のバッチモードのスクリプトファイルを用いて実現します。自動集計はCLIのスクリプトファイルを定期実行して実現します。定期実行については、Linuxのcronを利用します。

